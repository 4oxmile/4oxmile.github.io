<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#0D1117" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>CROSSY</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🎮</text></svg>" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="/css/leaderboard.css" />
</head>
<body>
<div id="app">
  <div id="game-wrapper">

    <!-- Canvas -->
    <canvas id="gameCanvas"></canvas>

    <!-- HUD -->
    <div id="hud" style="display:none;">
      <div class="hud-score" id="hud-score">0</div>
      <div class="hud-coins">
        <span>🪙</span>
        <span id="hud-coins">0</span>
      </div>
      <div class="hud-best" id="hud-best">최고: 0</div>
    </div>

    <!-- Pause button -->
    <div id="pause-btn" class="hidden" title="일시정지">⏸</div>

    <!-- Idle warning -->
    <div id="idle-warning">⚠ 서두르세요!</div>

    <!-- ── START SCREEN ── -->
    <div id="start-screen" class="overlay">
      <div class="game-title">CROSSY</div>
      <div class="game-subtitle">도로를 건너라</div>

      <div class="character-preview">🐣</div>

      <div class="best-score-display">
        🏆 최고 기록 <span class="score-value" id="start-best-score">0</span>
      </div>

      <button class="btn-primary" id="btn-start" onclick="startGame()">
        🎮 게임 시작
      </button>
      <button class="btn-secondary" onclick="showHowToPlay()">
        ❓ 도움말
      </button>
    </div>

    <!-- ── HOW TO PLAY ── -->
    <div id="howto-screen" class="overlay" style="padding: 32px 24px; text-align: center;">
      <div style="font-size: 28px; font-weight: 900; color: var(--text-primary); margin-bottom: 6px;">
        게임 방법
      </div>
      <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 32px;">How to play</div>

      <div style="display: flex; flex-direction: column; gap: 14px; margin-bottom: 36px; text-align: left; max-width: 280px;">
        <div style="display: flex; align-items: center; gap: 12px;">
          <span style="font-size: 28px; min-width: 36px; text-align: center;">🐣</span>
          <span style="font-size: 14px; color: var(--text-secondary);">화살표 키 또는 버튼으로 캐릭터를 이동하세요</span>
        </div>
        <div style="display: flex; align-items: center; gap: 12px;">
          <span style="font-size: 28px; min-width: 36px; text-align: center;">🚗</span>
          <span style="font-size: 14px; color: var(--text-secondary);">차에 치이지 않도록 조심하세요</span>
        </div>
        <div style="display: flex; align-items: center; gap: 12px;">
          <span style="font-size: 28px; min-width: 36px; text-align: center;">🪵</span>
          <span style="font-size: 14px; color: var(--text-secondary);">강에서는 통나무를 타고 건너세요</span>
        </div>
        <div style="display: flex; align-items: center; gap: 12px;">
          <span style="font-size: 28px; min-width: 36px; text-align: center;">🪙</span>
          <span style="font-size: 14px; color: var(--text-secondary);">코인을 모아 점수를 높이세요</span>
        </div>
        <div style="display: flex; align-items: center; gap: 12px;">
          <span style="font-size: 28px; min-width: 36px; text-align: center;">⏱</span>
          <span style="font-size: 14px; color: var(--text-secondary);">너무 오래 멈추면 밀려납니다!</span>
        </div>
      </div>

      <button class="btn-primary" onclick="hideHowToPlay()">
        알겠어요!
      </button>
    </div>

    <!-- ── PAUSE SCREEN ── -->
    <div id="pause-screen" class="overlay">
      <div style="font-size: 48px; margin-bottom: 8px;">⏸</div>
      <div class="pause-title">일시정지</div>
      <div class="pause-score" id="pause-score-val">0점</div>

      <button class="btn-primary" onclick="resumeGame()">
        ▶ 계속하기
      </button>
      <button class="btn-secondary" onclick="quitToMenu()">
        🏠 메인으로
      </button>
    </div>

    <!-- ── GAME OVER SCREEN ── -->
    <div id="gameover-screen" class="overlay">
      <div class="gameover-icon" id="gameover-icon">💥</div>
      <div class="gameover-title">게임 오버</div>

      <div class="new-record-badge hidden" id="new-record-badge">
        🏆 신기록!
      </div>

      <div class="score-cards">
        <div class="score-card">
          <div class="score-card-label">점수</div>
          <div class="score-card-value" id="go-score">0</div>
        </div>
        <div class="score-card">
          <div class="score-card-label">최고</div>
          <div class="score-card-value gold" id="go-best">0</div>
        </div>
        <div class="score-card">
          <div class="score-card-label">코인</div>
          <div class="score-card-value" id="go-coins">0</div>
        </div>
      </div>

      <button class="btn-primary" onclick="startGame()">
        🔄 다시 하기
      </button>
      <button class="btn-secondary" onclick="quitToMenu()">
        🏠 메인으로
      </button>
    </div>

    <!-- ── MOBILE CONTROLS ── -->
    <div id="mobile-controls" class="hidden">
      <div class="ctrl-row">
        <button class="ctrl-btn" id="btn-up" aria-label="위">▲</button>
      </div>
      <div class="ctrl-row">
        <button class="ctrl-btn" id="btn-left" aria-label="왼쪽">◀</button>
        <button class="ctrl-btn" id="btn-down" aria-label="아래">▼</button>
        <button class="ctrl-btn" id="btn-right" aria-label="오른쪽">▶</button>
      </div>
    </div>

  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="/js/supabase-config.js"></script>
<script src="/js/leaderboard.js"></script>
<script src="js/game.js"></script>
<script>
  function showHowToPlay() {
    document.getElementById('start-screen').classList.remove('visible');
    document.getElementById('howto-screen').classList.add('visible');
  }
  function hideHowToPlay() {
    document.getElementById('howto-screen').classList.remove('visible');
    document.getElementById('start-screen').classList.add('visible');
  }
  // quitToMenu is defined in game.js
</script>
</body>
</html>
